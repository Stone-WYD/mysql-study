{"objectClass":"NSDictionary","root":{"objectClass":"MindNode","ID":"MGLZ5","children":{"0":{"objectClass":"MindNode","ID":"LS723","children":{"0":{"objectClass":"MindNode","ID":"O2SGD","text":"","imageName":"QA7BSI62F4.png","imageSize":{"objectClass":"CGSize","width":769,"height":240},"imageResize":{"objectClass":"CGSize","width":578,"height":180.39011703511053}},"objectClass":"NSArray"},"text":"结构"},"1":{"objectClass":"MindNode","ID":"1606Y","children":{"0":{"objectClass":"MindNode","ID":"SET7R","children":{"0":{"objectClass":"MindNode","ID":"0MY9E","text":"头节点"},"1":{"objectClass":"MindNode","ID":"7NAN0","text":"尾节点"},"2":{"objectClass":"MindNode","ID":"VIC19","text":"节点数量等信息"},"objectClass":"NSArray"},"text":"基节点"},"1":{"objectClass":"MindNode","ID":"3V114","text":"其他链类似free链，都有基节点这样的结构，他们不占用Buffer Pool的空间","style2":{"objectClass":"NSDictionary","color":"#FF0000"}},"objectClass":"NSArray"},"text":"free链"},"2":{"objectClass":"MindNode","ID":"1F7H5","children":{"0":{"objectClass":"MindNode","ID":"666J5","text":"查看访问的页是否在Buffer Pool中时使用"},"1":{"objectClass":"MindNode","ID":"21NK7","text":"key：表空间号+页号，\nvalue：缓冲页控制块地址"},"objectClass":"NSArray"},"text":"缓冲页的哈希处理"},"3":{"objectClass":"MindNode","ID":"T51B2","children":{"0":{"objectClass":"MindNode","ID":"7201Z","text":"脏页：数据被修改过的页"},"1":{"objectClass":"MindNode","ID":"7134Q","text":"存储脏页的链表"},"2":{"objectClass":"MindNode","ID":"CV1V2","text":"会在某个时间将脏页中的数据刷新到磁盘中"},"3":{"objectClass":"MindNode","ID":"36KF3","text":"free链和flush链的节点是互斥的"},"objectClass":"NSArray"},"text":"flush链表","shrink":true},"4":{"objectClass":"MindNode","ID":"76C82","children":{"0":{"objectClass":"MindNode","ID":"6PBDL","text":"移出不常用缓存页时使用"},"1":{"objectClass":"MindNode","ID":"15O52","text":"Least Recently Used链表"},"2":{"objectClass":"MindNode","ID":"SG42R","children":{"0":{"objectClass":"MindNode","ID":"62437","text":"需要的页不在Buffer Pool中，则将其从磁盘读出后放在LRU链表最前面"},"1":{"objectClass":"MindNode","ID":"25VIR","text":"需要的页在Buffer Pool中，则将其从链表的位置移动到链表最前面"},"2":{"objectClass":"MindNode","ID":"1OMD4","text":"淘汰页面时选择LRU最后面的页面"},"3":{"objectClass":"MindNode","ID":"PNB7F","text":"但是预读和全表扫描会造成LRU使用起来效率变低"},"objectClass":"NSArray"},"text":"形成过程"},"3":{"objectClass":"MindNode","ID":"219I2","children":{"0":{"objectClass":"MindNode","ID":"4YHAP","text":"young和old的比例可以调整"},"1":{"objectClass":"MindNode","ID":"2R7NN","text":"","imageName":"3S6B042EYL.png","imageSize":{"objectClass":"CGSize","width":1058,"height":388},"imageResize":{"objectClass":"CGSize","width":549,"height":201.3345935727788}},"2":{"objectClass":"MindNode","ID":"Y0P19","children":{"0":{"objectClass":"MindNode","ID":"D7461","text":"预读：页面初次进入时会先进入old链，这样预读后如果没再次读，就会被淘汰掉"},"1":{"objectClass":"MindNode","ID":"47DDJ","text":"全表扫描：设置读取间隔时间，小于该时间的多次读，old里的页是不会被移动到young中（全表扫描两次读同一个页的时间间隔短）"},"objectClass":"NSArray"},"text":"优化措施"},"3":{"objectClass":"MindNode","ID":"EO172","children":{"0":{"objectClass":"MindNode","ID":"R63B6","text":"young链中控制块的位置不应该被经常移动，只有young区域1/4位置之后的控制块，再次读时才会改变链表位置"},"objectClass":"NSArray"},"text":"进一步优化"},"objectClass":"NSArray"},"text":"真正的LRU链表"},"objectClass":"NSArray"},"text":"LRU链表","shrink":true},"5":{"objectClass":"MindNode","ID":"G1545","children":{"0":{"objectClass":"MindNode","ID":"61H78","text":"BUF_FLUSH_LRU","remark":"从LRU链表刷","remarkDisplay":true},"1":{"objectClass":"MindNode","ID":"4J8D8","text":"BUF_FLUSH_LIST","remark":"从flush链表刷新","remarkDisplay":true},"2":{"objectClass":"MindNode","ID":"23EPM","text":"BUF_FLUSH_SINGLE_PAGE","remark":"后台刷新脏页进度较慢，影响用户线程且LRU链表尾部没有可以直接释放掉的未修改缓冲页时，会将LRU链表尾部的脏页同步刷新到磁盘"},"objectClass":"NSArray"},"text":"刷新脏页到磁盘","shrink":true},"6":{"objectClass":"MindNode","ID":"6MB3L","children":{"0":{"objectClass":"MindNode","ID":"761XK","text":"多个Buffer Pool实例，\n适应多线程环境"},"1":{"objectClass":"MindNode","ID":"MS423","text":"为了让buffer pool 大小可变，实际\n控制块和页是放在一个个chunk中的。"},"2":{"objectClass":"MindNode","ID":"8V2D0","text":"innodb_buffer_pool_size 是 innodb_buffer_pool_chunk_size ✖ innodb_buffer_pool_instances的倍数"},"objectClass":"NSArray"},"text":"一些特点","shrink":true},"7":{"objectClass":"MindNode","ID":"QE512","text":"show engine \ninnodb status"},"objectClass":"NSArray"},"text":"Buffer Pool"},"ID":"V987Y","style":100,"lineKeepThin":true}